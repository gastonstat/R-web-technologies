<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Web APIs | Web Technologies in R</title>
  <meta name="description" content="<p>This tutorial provides a a short introduction to some of the Web Data
Technologies available in R.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Web APIs | Web Technologies in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This tutorial provides a a short introduction to some of the Web Data
Technologies available in R.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Web APIs | Web Technologies in R" />
  
  <meta name="twitter:description" content="<p>This tutorial provides a a short introduction to some of the Web Data
Technologies available in R.</p>" />
  

<meta name="author" content="Gaston Sanchez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="jsonlite.html"/>
<link rel="next" href="api-open-notify.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>Web Technologies in R</b><br><small>Gaston Sanchez</small></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-series-of-r-tutorials"><i class="fa fa-check"></i>My Series of R Tutorials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#donation"><i class="fa fa-check"></i>Donation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I Intro</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#suggested-tools"><i class="fa fa-check"></i><b>1.1</b> Suggested Tools</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#suggested-r-packages"><i class="fa fa-check"></i><b>1.2</b> Suggested R Packages</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#some-acronyms"><i class="fa fa-check"></i><b>1.3</b> Some Acronyms</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="web.html"><a href="web.html"><i class="fa fa-check"></i><b>2</b> The Web</a>
<ul>
<li class="chapter" data-level="2.1" data-path="web.html"><a href="web.html#surfing-the-web"><i class="fa fa-check"></i><b>2.1</b> Surfing the Web</a></li>
<li class="chapter" data-level="2.2" data-path="web.html"><a href="web.html#how-does-the-web-work"><i class="fa fa-check"></i><b>2.2</b> How Does the Web Work?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="http.html"><a href="http.html"><i class="fa fa-check"></i><b>3</b> Basics of HTTP</a>
<ul>
<li class="chapter" data-level="3.1" data-path="http.html"><a href="http.html#what-is-http"><i class="fa fa-check"></i><b>3.1</b> What is HTTP?</a></li>
<li class="chapter" data-level="3.2" data-path="http.html"><a href="http.html#a-quick-introduction-to-http"><i class="fa fa-check"></i><b>3.2</b> A quick introduction to HTTP</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="http.html"><a href="http.html#http-example"><i class="fa fa-check"></i><b>3.2.1</b> HTTP Example</a></li>
<li class="chapter" data-level="3.2.2" data-path="http.html"><a href="http.html#http-request"><i class="fa fa-check"></i><b>3.2.2</b> HTTP Request</a></li>
<li class="chapter" data-level="3.2.3" data-path="http.html"><a href="http.html#http-response"><i class="fa fa-check"></i><b>3.2.3</b> HTTP Response</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="http.html"><a href="http.html#anatomy-of-an-http-message"><i class="fa fa-check"></i><b>3.3</b> Anatomy of an HTTP message</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="http.html"><a href="http.html#http-methods"><i class="fa fa-check"></i><b>3.3.1</b> HTTP Methods</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II XML</b></span></li>
<li class="chapter" data-level="4" data-path="xml.html"><a href="xml.html"><i class="fa fa-check"></i><b>4</b> Basics of XML</a>
<ul>
<li class="chapter" data-level="4.1" data-path="xml.html"><a href="xml.html#what-is-xml"><i class="fa fa-check"></i><b>4.1</b> What is XML?</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="xml.html"><a href="xml.html#marks-in-xml"><i class="fa fa-check"></i><b>4.1.1</b> Marks in XML</a></li>
<li class="chapter" data-level="4.1.2" data-path="xml.html"><a href="xml.html#minimalist-example"><i class="fa fa-check"></i><b>4.1.2</b> Minimalist Example</a></li>
<li class="chapter" data-level="4.1.3" data-path="xml.html"><a href="xml.html#well-formedness"><i class="fa fa-check"></i><b>4.1.3</b> Well Formedness</a></li>
<li class="chapter" data-level="4.1.4" data-path="xml.html"><a href="xml.html#additional-xml-elements"><i class="fa fa-check"></i><b>4.1.4</b> Additional XML Elements</a></li>
<li class="chapter" data-level="4.1.5" data-path="xml.html"><a href="xml.html#another-example"><i class="fa fa-check"></i><b>4.1.5</b> Another Example</a></li>
<li class="chapter" data-level="4.1.6" data-path="xml.html"><a href="xml.html#wrapping-up"><i class="fa fa-check"></i><b>4.1.6</b> Wrapping-Up</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="parsing-xml.html"><a href="parsing-xml.html"><i class="fa fa-check"></i><b>5</b> Parsing XML</a>
<ul>
<li class="chapter" data-level="5.1" data-path="parsing-xml.html"><a href="parsing-xml.html#what-is-parsing"><i class="fa fa-check"></i><b>5.1</b> What is parsing?</a></li>
<li class="chapter" data-level="5.2" data-path="parsing-xml.html"><a href="parsing-xml.html#r-package-xml2"><i class="fa fa-check"></i><b>5.2</b> R package <code>"xml2"</code></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="parsing-xml.html"><a href="parsing-xml.html#parsing-functions"><i class="fa fa-check"></i><b>5.2.1</b> Parsing Functions</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="parsing-xml.html"><a href="parsing-xml.html#working-with-parsed-documents"><i class="fa fa-check"></i><b>5.3</b> Working with parsed documents</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="parsing-xml.html"><a href="parsing-xml.html#example-with-a-basic-xml-document"><i class="fa fa-check"></i><b>5.3.1</b> Example with a basic XML document</a></li>
<li class="chapter" data-level="5.3.2" data-path="parsing-xml.html"><a href="parsing-xml.html#more-functions-in-xml2"><i class="fa fa-check"></i><b>5.3.2</b> More Functions in <code>"xml2"</code></a></li>
<li class="chapter" data-level="5.3.3" data-path="parsing-xml.html"><a href="parsing-xml.html#navigation-of-xml-html-tree"><i class="fa fa-check"></i><b>5.3.3</b> Navigation of XML / HTML Tree</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="xpath.html"><a href="xpath.html"><i class="fa fa-check"></i><b>6</b> XPath Language</a>
<ul>
<li class="chapter" data-level="6.1" data-path="xpath.html"><a href="xpath.html#what-is-xpath"><i class="fa fa-check"></i><b>6.1</b> What is XPath?</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="xpath.html"><a href="xpath.html#xpath-syntax"><i class="fa fa-check"></i><b>6.1.1</b> XPath Syntax</a></li>
<li class="chapter" data-level="6.1.2" data-path="xpath.html"><a href="xpath.html#selecting-nodes"><i class="fa fa-check"></i><b>6.1.2</b> Selecting Nodes</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="xpath.html"><a href="xpath.html#xpath-examples"><i class="fa fa-check"></i><b>6.2</b> XPath Examples</a></li>
<li class="chapter" data-level="6.3" data-path="xpath.html"><a href="xpath.html#using-xpath-functions"><i class="fa fa-check"></i><b>6.3</b> Using XPath Functions</a></li>
</ul></li>
<li class="part"><span><b>III HTML</b></span></li>
<li class="chapter" data-level="7" data-path="html.html"><a href="html.html"><i class="fa fa-check"></i><b>7</b> Basics of HTML</a>
<ul>
<li class="chapter" data-level="7.1" data-path="html.html"><a href="html.html#a-quick-introduction-to-html"><i class="fa fa-check"></i><b>7.1</b> A quick introduction to HTML</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="html.html"><a href="html.html#html-document-structure"><i class="fa fa-check"></i><b>7.1.1</b> HTML document structure</a></li>
<li class="chapter" data-level="7.1.2" data-path="html.html"><a href="html.html#html-syntax"><i class="fa fa-check"></i><b>7.1.2</b> HTML Syntax</a></li>
<li class="chapter" data-level="7.1.3" data-path="html.html"><a href="html.html#what-the-browser-does"><i class="fa fa-check"></i><b>7.1.3</b> What the browser does</a></li>
<li class="chapter" data-level="7.1.4" data-path="html.html"><a href="html.html#web-scraping"><i class="fa fa-check"></i><b>7.1.4</b> Web Scraping</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV JSON</b></span></li>
<li class="chapter" data-level="8" data-path="json.html"><a href="json.html"><i class="fa fa-check"></i><b>8</b> JSON Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="json.html"><a href="json.html#json-basics"><i class="fa fa-check"></i><b>8.1</b> JSON Basics</a></li>
<li class="chapter" data-level="8.2" data-path="json.html"><a href="json.html#what-is-json"><i class="fa fa-check"></i><b>8.2</b> What is JSON?</a></li>
<li class="chapter" data-level="8.3" data-path="json.html"><a href="json.html#understanding-json-syntax"><i class="fa fa-check"></i><b>8.3</b> Understanding JSON Syntax</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="json.html"><a href="json.html#data-types"><i class="fa fa-check"></i><b>8.3.1</b> Data Types</a></li>
<li class="chapter" data-level="8.3.2" data-path="json.html"><a href="json.html#arrays"><i class="fa fa-check"></i><b>8.3.2</b> Arrays</a></li>
<li class="chapter" data-level="8.3.3" data-path="json.html"><a href="json.html#objects"><i class="fa fa-check"></i><b>8.3.3</b> Objects</a></li>
<li class="chapter" data-level="8.3.4" data-path="json.html"><a href="json.html#examples-of-json-data-containers"><i class="fa fa-check"></i><b>8.3.4</b> Examples of JSON Data Containers</a></li>
<li class="chapter" data-level="8.3.5" data-path="json.html"><a href="json.html#data-table-toy-example"><i class="fa fa-check"></i><b>8.3.5</b> Data Table Toy Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="jsonlite.html"><a href="jsonlite.html"><i class="fa fa-check"></i><b>9</b> JSON R packages</a>
<ul>
<li class="chapter" data-level="9.1" data-path="jsonlite.html"><a href="jsonlite.html#function-tojson"><i class="fa fa-check"></i><b>9.1</b> Function <code>toJSON()</code></a></li>
<li class="chapter" data-level="9.2" data-path="jsonlite.html"><a href="jsonlite.html#function-fromjson"><i class="fa fa-check"></i><b>9.2</b> Function <code>fromJSON()</code></a></li>
<li class="chapter" data-level="9.3" data-path="jsonlite.html"><a href="jsonlite.html#reading-json-data"><i class="fa fa-check"></i><b>9.3</b> Reading JSON Data</a></li>
</ul></li>
<li class="part"><span><b>V APIs</b></span></li>
<li class="chapter" data-level="10" data-path="apis.html"><a href="apis.html"><i class="fa fa-check"></i><b>10</b> Web APIs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="apis.html"><a href="apis.html#introduction-1"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="apis.html"><a href="apis.html#a-little-bit-about-apis"><i class="fa fa-check"></i><b>10.2</b> A little bit about APIs</a></li>
<li class="chapter" data-level="10.3" data-path="apis.html"><a href="apis.html#using-r-as-an-http-client"><i class="fa fa-check"></i><b>10.3</b> Using R as an HTTP Client</a></li>
<li class="chapter" data-level="10.4" data-path="apis.html"><a href="apis.html#interacting-with-aps-via-r"><i class="fa fa-check"></i><b>10.4</b> Interacting with AP’s via R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="apis.html"><a href="apis.html#making-request-from-r"><i class="fa fa-check"></i><b>10.4.1</b> Making request from R</a></li>
<li class="chapter" data-level="10.4.2" data-path="apis.html"><a href="apis.html#performing-a-request"><i class="fa fa-check"></i><b>10.4.2</b> Performing a Request</a></li>
<li class="chapter" data-level="10.4.3" data-path="apis.html"><a href="apis.html#extracting-response-as-string"><i class="fa fa-check"></i><b>10.4.3</b> Extracting response as string</a></li>
<li class="chapter" data-level="10.4.4" data-path="apis.html"><a href="apis.html#extracting-response-as-html"><i class="fa fa-check"></i><b>10.4.4</b> Extracting response as HTML</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="apis.html"><a href="apis.html#example-search-with-advice-id"><i class="fa fa-check"></i><b>10.5</b> Example: Search with Advice ID</a></li>
<li class="chapter" data-level="10.6" data-path="apis.html"><a href="apis.html#example-search-query"><i class="fa fa-check"></i><b>10.6</b> Example: Search Query</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="api-open-notify.html"><a href="api-open-notify.html"><i class="fa fa-check"></i><b>11</b> Open Notify API</a>
<ul>
<li class="chapter" data-level="11.1" data-path="api-open-notify.html"><a href="api-open-notify.html#introduction-2"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="api-open-notify.html"><a href="api-open-notify.html#current-iss-location"><i class="fa fa-check"></i><b>11.2</b> Current ISS Location</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="api-open-notify.html"><a href="api-open-notify.html#getting-location-approach-1"><i class="fa fa-check"></i><b>11.2.1</b> Getting Location (Approach 1)</a></li>
<li class="chapter" data-level="11.2.2" data-path="api-open-notify.html"><a href="api-open-notify.html#getting-location-approach-2"><i class="fa fa-check"></i><b>11.2.2</b> Getting Location (Approach 2)</a></li>
<li class="chapter" data-level="11.2.3" data-path="api-open-notify.html"><a href="api-open-notify.html#map-with-leaflet-ver-1"><i class="fa fa-check"></i><b>11.2.3</b> Map with <code>"leaflet"</code> (ver 1)</a></li>
<li class="chapter" data-level="11.2.4" data-path="api-open-notify.html"><a href="api-open-notify.html#map-with-leaflet-ver-2"><i class="fa fa-check"></i><b>11.2.4</b> Map with <code>"leaflet"</code> (ver 2)</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="api-open-notify.html"><a href="api-open-notify.html#astronauts-in-space"><i class="fa fa-check"></i><b>11.3</b> Astronauts in Space</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="api-open-notify.html"><a href="api-open-notify.html#getting-data-with-http-request"><i class="fa fa-check"></i><b>11.3.1</b> Getting Data with HTTP request</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="api-pubmed.html"><a href="api-pubmed.html"><i class="fa fa-check"></i><b>12</b> PubMed API Example</a>
<ul>
<li class="chapter" data-level="12.1" data-path="api-pubmed.html"><a href="api-pubmed.html#pubmed"><i class="fa fa-check"></i><b>12.1</b> PubMed</a></li>
<li class="chapter" data-level="12.2" data-path="api-pubmed.html"><a href="api-pubmed.html#basics-of-e-utilities"><i class="fa fa-check"></i><b>12.2</b> Basics of E-utilities</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="api-pubmed.html"><a href="api-pubmed.html#how-does-e-utilities-work"><i class="fa fa-check"></i><b>12.2.1</b> How does E-utilities work?</a></li>
<li class="chapter" data-level="12.2.2" data-path="api-pubmed.html"><a href="api-pubmed.html#searching-pubmed-from-within-r"><i class="fa fa-check"></i><b>12.2.2</b> Searching PubMed from within R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.gastonsanchez.com" target="_blank">gastonsanchez.com</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Web Technologies in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="apis" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Web APIs<a href="apis.html#apis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we’ll give you a crash introduction to Web APIs, and how to
use R for interacting with them.</p>
<p>You will need the following packages</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="apis.html#cb85-1" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb85-2"><a href="apis.html#cb85-2" tabindex="-1"></a><span class="fu">library</span>(xml2)</span>
<span id="cb85-3"><a href="apis.html#cb85-3" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span></code></pre></div>
<div id="introduction-1" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Introduction<a href="apis.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far we’ve been dealing with data sets in various formats: internal data
objects in R (e.g. data tibble <code>starwars</code>), built-in data frames such as
<code>mtcars</code> or <code>oldfaithful</code>), reading files stored in your computer (txt, csv,
tsv, etc). But you also need to learn how to get data from the web.</p>
<p>For better or worse, reading data from the Web entails a whole other set of
considerations. Because of the large variety of data formats available in the
Web, we will primarily focus on retrieving data from
<em>Application Programming Interfaces</em> also known as APIs.</p>
<p>The reason to focus on APIs is because nowadays many companies, websites,
sources, etc. use APIs as their primary means to share information and data.
Many large websites like Reddit, Twitter and Facebook offer APIs so that data
analysts and data scientists can access interesting data. And having an API to
share data has become a standard thing to have.</p>
</div>
<div id="a-little-bit-about-apis" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> A little bit about APIs<a href="apis.html#a-little-bit-about-apis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>API stands for <strong>Application Programming Interface</strong>. If this sounds too fancy
or cryptic for you, then simply think of it as a “Data Sharing Interface”.</p>
<p>Instead of having to download a data file, an API allows programmers to request
data directly from a website. From a technical point of view, an API is a set
of rules, protocols, and tools for building software and applications.</p>
<div id="what-is-an-api" class="section level4 unnumbered hasAnchor">
<h4>What is an API?<a href="apis.html#what-is-an-api" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>“API” is a general term for the place where one computer program (the client)
interacts with another (the server), or with itself.</p>
<p>APIs offer data scientists a polished way to request clean and curated data
from a website. When a website like Facebook sets up an API, they are
essentially setting up a computer that waits for data requests.</p>
<p>Once this computer receives a data request, it will do its own processing of
the data and send it to the computer that requested it. From our perspective
as the requester, we will need to write code in R that creates the request and
tells the computer running the API what we need. That computer will then read
our code, process the request, and return nicely-formatted data that can be
easily parsed by existing R libraries.</p>
</div>
<div id="why-to-use-an-api" class="section level4 unnumbered hasAnchor">
<h4>Why to use an API?<a href="apis.html#why-to-use-an-api" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Why is this valuable? Contrast the API approach to pure web scraping. When a
programmer scrapes a web page, they receive the data in a messy chunk of HTML.
While there are certainly libraries out there that make parsing HTML text easy,
these are all cleaning steps that need to be taken before we even get our hands
on the data we want!</p>
<p>Often, we can immediately use the data we get from an API, which saves us time
and frustration.</p>
</div>
</div>
<div id="using-r-as-an-http-client" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Using R as an HTTP Client<a href="apis.html#using-r-as-an-http-client" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R has a few HTTP client packages: <code>"crul"</code>, <code>"curl"</code>, <code>"httr2"</code>, and <code>"RCurl"</code>;
you can think of them as “high-level R HTTP clients” which basically let you
use R (and your computer) as an <strong>HTTP client</strong>.</p>
<p>We will describe how to use functions from <code>"httr2"</code> (pronounced <em>hitter2</em>).</p>
</div>
<div id="interacting-with-aps-via-r" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Interacting with AP’s via R<a href="apis.html#interacting-with-aps-via-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In R, we can use the <code>"httr2"</code> package to make http requests and handle the
responses.</p>
<p>Let’s start with baby steps using the website <a href="https://api.adviceslip.com/" class="uri">https://api.adviceslip.com/</a>
which provides an API—developed by Tom Kiss—to get a free piece of advice
from the internet.</p>
<p>The first thing you need to do is to look at the <em>adviceslip</em> website to
familiarize yourself with the functionalities it provides.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-113"></span>
<img src="images/api/advice-slip.png" alt="Advice Slip JSON API" width="75%" />
<p class="caption">
Figure 10.1: Advice Slip JSON API
</p>
</div>
<p><br></p>
<p>The url <code>https://api.adviceslip.com/advice</code> will give you a random advice, for
example:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-114"></span>
<img src="images/api/advice-slip-happiness.png" alt="Random advice from Advice Slip" width="80%" />
<p class="caption">
Figure 10.2: Random advice from Advice Slip
</p>
</div>
<p>Notice that the format of the response is provided in JSON format. In the above
example, the advice content is given as:</p>
<pre><code>{&quot;slip&quot;: {&quot;id&quot;: 9, &quot;advice&quot;: &quot;True happiness always resides in the quest.&quot;}}</code></pre>
<p>which we can mentally rearrange as:</p>
<pre><code>{
  &quot;slip&quot;: {
    &quot;id&quot;: 9, 
    &quot;advice&quot;: &quot;True happiness always resides in the quest.&quot;
  }
}</code></pre>
<p>Getting a random advice is quite simple, all you need is to make an HTTP
request using the url <code>https://api.adviceslip.com/advice</code>.</p>
<div id="making-request-from-r" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> Making request from R<a href="apis.html#making-request-from-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Interestingly, we can make such request from R, using it as a server. This
requires employing some functions from <code>"httr2"</code>.</p>
<p>In <code>"httr2"</code>, you start by creating a <strong>request</strong>. How? You use the <code>request()</code>
function which creates a request object. To be clear, <code>request()</code> does not
submit the request, it only creates the object, which you can use to build up a
complex request piece by piece, and works well with the pipe operators <code>|&gt;</code>
or <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="apis.html#cb88-1" tabindex="-1"></a><span class="co"># start a request object</span></span>
<span id="cb88-2"><a href="apis.html#cb88-2" tabindex="-1"></a>advice_url <span class="ot">=</span> <span class="st">&quot;https://api.adviceslip.com&quot;</span></span>
<span id="cb88-3"><a href="apis.html#cb88-3" tabindex="-1"></a>req <span class="ot">=</span> <span class="fu">request</span>(advice_url)</span>
<span id="cb88-4"><a href="apis.html#cb88-4" tabindex="-1"></a>req</span>
<span id="cb88-5"><a href="apis.html#cb88-5" tabindex="-1"></a><span class="co">#&gt; &lt;httr2_request&gt;</span></span>
<span id="cb88-6"><a href="apis.html#cb88-6" tabindex="-1"></a><span class="co">#&gt; GET https://api.adviceslip.com</span></span>
<span id="cb88-7"><a href="apis.html#cb88-7" tabindex="-1"></a><span class="co">#&gt; Body: empty</span></span></code></pre></div>
<p>To see what this request will send to the server we perform a dry run:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="apis.html#cb89-1" tabindex="-1"></a>req <span class="sc">|&gt;</span> <span class="fu">req_dry_run</span>()</span>
<span id="cb89-2"><a href="apis.html#cb89-2" tabindex="-1"></a><span class="co">#&gt; GET / HTTP/1.1</span></span>
<span id="cb89-3"><a href="apis.html#cb89-3" tabindex="-1"></a><span class="co">#&gt; Host: api.adviceslip.com</span></span>
<span id="cb89-4"><a href="apis.html#cb89-4" tabindex="-1"></a><span class="co">#&gt; User-Agent: httr2/1.0.0 r-curl/5.1.0 libcurl/7.79.1</span></span>
<span id="cb89-5"><a href="apis.html#cb89-5" tabindex="-1"></a><span class="co">#&gt; Accept: */*</span></span>
<span id="cb89-6"><a href="apis.html#cb89-6" tabindex="-1"></a><span class="co">#&gt; Accept-Encoding: deflate, gzip</span></span></code></pre></div>
<p>What’s going on with the first line <code>GET / HTTP/1.1</code>?</p>
<ul>
<li><p>The first term, <code>GET</code>, refers to the HTTP <strong>method</strong>, which is a
verb that tells the server what you want to do. In this case is <code>GET</code>, the most
common verb, indicating that we want to get a resource. Other verbs include
<code>POST</code>, to create a new resource; <code>PUT</code>, to replace an existing resource; and
<code>DELETE</code>, to delete a resource.</p></li>
<li><p>The second part, <code>/</code>, is the <strong>path</strong> which is the URL stripped of details
that the server already knows, i.e. the protocol (http or https), and the host
(localhost).</p></li>
<li><p>The third element, <code>HTTP/1.1</code>, is the version of the HTTP protocol. This is
unimportant for our purposes because it’s handled at a lower level.</p></li>
</ul>
<p>In order to make a request with <code>"httr2"</code>, we need to complete the full path
of the URL. In the above example, this is done with <code>req_url_path_append()</code></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="apis.html#cb90-1" tabindex="-1"></a><span class="co"># then we complete the full path</span></span>
<span id="cb90-2"><a href="apis.html#cb90-2" tabindex="-1"></a>req <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="apis.html#cb90-3" tabindex="-1"></a>  <span class="fu">req_url_path_append</span>(<span class="st">&quot;advice&quot;</span>) </span>
<span id="cb90-4"><a href="apis.html#cb90-4" tabindex="-1"></a><span class="co">#&gt; &lt;httr2_request&gt;</span></span>
<span id="cb90-5"><a href="apis.html#cb90-5" tabindex="-1"></a><span class="co">#&gt; GET https://api.adviceslip.com/advice</span></span>
<span id="cb90-6"><a href="apis.html#cb90-6" tabindex="-1"></a><span class="co">#&gt; Body: empty</span></span></code></pre></div>
<p>Observe that the output of this command has the full path of the request:
<code>https://api.adviceslip.com/advice</code>.</p>
</div>
<div id="performing-a-request" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> Performing a Request<a href="apis.html#performing-a-request" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once we have the desired request object, then we can submit it or <strong>perform</strong>
such request with <code>req_perform()</code>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="apis.html#cb91-1" tabindex="-1"></a><span class="co"># then add on the query path</span></span>
<span id="cb91-2"><a href="apis.html#cb91-2" tabindex="-1"></a>resp <span class="ot">=</span> req <span class="sc">|&gt;</span></span>
<span id="cb91-3"><a href="apis.html#cb91-3" tabindex="-1"></a>  <span class="fu">req_url_path_append</span>(<span class="st">&quot;advice&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb91-4"><a href="apis.html#cb91-4" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb91-5"><a href="apis.html#cb91-5" tabindex="-1"></a></span>
<span id="cb91-6"><a href="apis.html#cb91-6" tabindex="-1"></a>resp</span>
<span id="cb91-7"><a href="apis.html#cb91-7" tabindex="-1"></a><span class="co">#&gt; &lt;httr2_response&gt;</span></span>
<span id="cb91-8"><a href="apis.html#cb91-8" tabindex="-1"></a><span class="co">#&gt; GET https://api.adviceslip.com/advice</span></span>
<span id="cb91-9"><a href="apis.html#cb91-9" tabindex="-1"></a><span class="co">#&gt; Status: 200 OK</span></span>
<span id="cb91-10"><a href="apis.html#cb91-10" tabindex="-1"></a><span class="co">#&gt; Content-Type: text/html</span></span>
<span id="cb91-11"><a href="apis.html#cb91-11" tabindex="-1"></a><span class="co">#&gt; Body: In memory (77 bytes)</span></span></code></pre></div>
<p>As you can tell, the response has a success status (<code>200 OK</code>), and the fetched
content is text in html format.</p>
<p>The object <code>resp</code> is an object of class <code>"httr2_response"</code>, which is basically
an R list that contains 7 elements:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="apis.html#cb92-1" tabindex="-1"></a><span class="fu">names</span>(resp)</span>
<span id="cb92-2"><a href="apis.html#cb92-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;method&quot;      &quot;url&quot;         &quot;status_code&quot; &quot;headers&quot;     &quot;body&quot;       </span></span>
<span id="cb92-3"><a href="apis.html#cb92-3" tabindex="-1"></a><span class="co">#&gt; [6] &quot;request&quot;     &quot;cache&quot; </span></span></code></pre></div>
<p>One of the elements in <code>resp</code> is <code>"body"</code> which is the element that is supposed
to contain the response content. If we take a look at the body we get an
interesting—but unhelpful—output:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="apis.html#cb93-1" tabindex="-1"></a>resp<span class="sc">$</span>body</span>
<span id="cb93-2"><a href="apis.html#cb93-2" tabindex="-1"></a><span class="co">#&gt;  [1] 7b 22 73 6c 69 70 22 3a 20 7b 20 22 69 64 22 3a 20 39 2c 20 22 61 64 76</span></span>
<span id="cb93-3"><a href="apis.html#cb93-3" tabindex="-1"></a><span class="co">#&gt; [25] 69 63 65 22 3a 20 22 54 72 75 65 20 68 61 70 70 69 6e 65 73 73 20 61 6c</span></span>
<span id="cb93-4"><a href="apis.html#cb93-4" tabindex="-1"></a><span class="co">#&gt; [49] 77 61 79 73 20 72 65 73 69 64 65 73 20 69 6e 20 74 68 65 20 71 75 65 73</span></span>
<span id="cb93-5"><a href="apis.html#cb93-5" tabindex="-1"></a><span class="co">#&gt; [73] 74 2e 22 7d 7d</span></span></code></pre></div>
<p>What kind of object is <code>resp$body</code>? Inspecting its <code>class()</code>, it turns out
that this is an object of class <code>"raw"</code> or <em>raw vector</em>, which is a vector
that holds raw bytes in R.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="apis.html#cb94-1" tabindex="-1"></a><span class="fu">class</span>(resp<span class="sc">$</span>body)</span>
<span id="cb94-2"><a href="apis.html#cb94-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;raw&quot;</span></span></code></pre></div>
<p>Technically speaking, a raw vector is printed with each byte separately
represented as a pair of hex digits. If you want to see a character
representation (with escape sequences for non-printing characters) use
<code>rawToChar()</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="apis.html#cb95-1" tabindex="-1"></a>body_json <span class="ot">=</span> <span class="fu">rawToChar</span>(resp<span class="sc">$</span>body)</span>
<span id="cb95-2"><a href="apis.html#cb95-2" tabindex="-1"></a></span>
<span id="cb95-3"><a href="apis.html#cb95-3" tabindex="-1"></a>body_json</span>
<span id="cb95-4"><a href="apis.html#cb95-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;{\&quot;slip\&quot;: { \&quot;id\&quot;: 9, \&quot;advice\&quot;: \&quot;True happiness always resides in the quest.\&quot;}}&quot;</span></span></code></pre></div>
<p>Converting the raw vector into text, we obtain the response body <code>body_json</code>
which is text in JSON format. Then, to parse this JSON text, we use <code>fromJSON()</code>
which returns an R list:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="apis.html#cb96-1" tabindex="-1"></a>slip_advice <span class="ot">=</span> <span class="fu">fromJSON</span>(body_json)</span>
<span id="cb96-2"><a href="apis.html#cb96-2" tabindex="-1"></a></span>
<span id="cb96-3"><a href="apis.html#cb96-3" tabindex="-1"></a>slip_advice</span>
<span id="cb96-4"><a href="apis.html#cb96-4" tabindex="-1"></a><span class="co">#&gt; $slip</span></span>
<span id="cb96-5"><a href="apis.html#cb96-5" tabindex="-1"></a><span class="co">#&gt; $slip$id</span></span>
<span id="cb96-6"><a href="apis.html#cb96-6" tabindex="-1"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb96-7"><a href="apis.html#cb96-7" tabindex="-1"></a></span>
<span id="cb96-8"><a href="apis.html#cb96-8" tabindex="-1"></a><span class="co">#&gt; $slip$advice</span></span>
<span id="cb96-9"><a href="apis.html#cb96-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;True happiness always resides in the quest.&quot;</span></span></code></pre></div>
<p>And finally, we extract the piece of advice as follows:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="apis.html#cb97-1" tabindex="-1"></a>slip_advice<span class="sc">$</span>slip<span class="sc">$</span>advice</span>
<span id="cb97-2"><a href="apis.html#cb97-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;True happiness always resides in the quest.&quot;</span></span></code></pre></div>
</div>
<div id="extracting-response-as-string" class="section level3 hasAnchor" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> Extracting response as string<a href="apis.html#extracting-response-as-string" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let me show you another—more straightforward—way to extract the content of
the response body by using one of the <code>resp_body_()</code> functions, in particular
the <code>resp_body_string()</code> function:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="apis.html#cb98-1" tabindex="-1"></a>resp <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>()</span>
<span id="cb98-2"><a href="apis.html#cb98-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;{\&quot;slip\&quot;: { \&quot;id\&quot;: 9, \&quot;advice\&quot;: \&quot;True happiness always resides in the quest.\&quot;}}&quot;</span></span></code></pre></div>
<p>Notice that we obtain the same JSON text, which we can parse with <code>fromJSON()</code></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="apis.html#cb99-1" tabindex="-1"></a>resp <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb99-2"><a href="apis.html#cb99-2" tabindex="-1"></a><span class="co">#&gt; $slip</span></span>
<span id="cb99-3"><a href="apis.html#cb99-3" tabindex="-1"></a><span class="co">#&gt; $slip$id</span></span>
<span id="cb99-4"><a href="apis.html#cb99-4" tabindex="-1"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb99-5"><a href="apis.html#cb99-5" tabindex="-1"></a></span>
<span id="cb99-6"><a href="apis.html#cb99-6" tabindex="-1"></a><span class="co">#&gt; $slip$advice</span></span>
<span id="cb99-7"><a href="apis.html#cb99-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;True happiness always resides in the quest.&quot;</span></span></code></pre></div>
</div>
<div id="extracting-response-as-html" class="section level3 hasAnchor" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> Extracting response as HTML<a href="apis.html#extracting-response-as-html" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A third equivalent method to extract the response body is with the function
<code>resp_body_html()</code>. The reason why we can do that in this case has to do with
the fact that the content of the response is in HTML format:
<code>Content-Type: text/html</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="apis.html#cb100-1" tabindex="-1"></a><span class="co"># the result &quot;resp&quot; comes back as html</span></span>
<span id="cb100-2"><a href="apis.html#cb100-2" tabindex="-1"></a><span class="co"># Let&#39;s extract body from response</span></span>
<span id="cb100-3"><a href="apis.html#cb100-3" tabindex="-1"></a>doc_html <span class="ot">=</span> resp <span class="sc">|&gt;</span> <span class="fu">resp_body_html</span>()</span>
<span id="cb100-4"><a href="apis.html#cb100-4" tabindex="-1"></a></span>
<span id="cb100-5"><a href="apis.html#cb100-5" tabindex="-1"></a>doc_html</span>
<span id="cb100-6"><a href="apis.html#cb100-6" tabindex="-1"></a><span class="co">#&gt; {html_document}</span></span>
<span id="cb100-7"><a href="apis.html#cb100-7" tabindex="-1"></a><span class="co">#&gt; &lt;html&gt;</span></span>
<span id="cb100-8"><a href="apis.html#cb100-8" tabindex="-1"></a><span class="co">#&gt; [1] &lt;body&gt;&lt;p&gt;{&quot;slip&quot;: { &quot;id&quot;: 9, &quot;advice&quot;: &quot;True happiness always resides ...</span></span></code></pre></div>
<p>Since the output is an <code>html_document</code>, we first need to extract the text of
the <code>&lt;p&gt;</code> element. One option to achieve this is with an xpath expression:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="apis.html#cb101-1" tabindex="-1"></a>txt_json <span class="ot">=</span> doc_html <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="apis.html#cb101-2" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="at">xpath =</span> <span class="st">&quot;//p&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb101-3"><a href="apis.html#cb101-3" tabindex="-1"></a>  <span class="fu">xml_text</span>()</span>
<span id="cb101-4"><a href="apis.html#cb101-4" tabindex="-1"></a></span>
<span id="cb101-5"><a href="apis.html#cb101-5" tabindex="-1"></a>txt_json</span>
<span id="cb101-6"><a href="apis.html#cb101-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;{\&quot;slip\&quot;: { \&quot;id\&quot;: 9, \&quot;advice\&quot;: \&quot;True happiness always resides in the quest.\&quot;}}&quot;</span></span></code></pre></div>
<p>This still requires some JSON parsing with <code>fromJSON()</code>:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="apis.html#cb102-1" tabindex="-1"></a>slip_advice <span class="ot">=</span> <span class="fu">fromJSON</span>(txt_json)</span>
<span id="cb102-2"><a href="apis.html#cb102-2" tabindex="-1"></a>slip_advice</span>
<span id="cb102-3"><a href="apis.html#cb102-3" tabindex="-1"></a><span class="co">#&gt; $slip</span></span>
<span id="cb102-4"><a href="apis.html#cb102-4" tabindex="-1"></a><span class="co">#&gt; $slip$id</span></span>
<span id="cb102-5"><a href="apis.html#cb102-5" tabindex="-1"></a><span class="co">#&gt; [1] 9</span></span>
<span id="cb102-6"><a href="apis.html#cb102-6" tabindex="-1"></a></span>
<span id="cb102-7"><a href="apis.html#cb102-7" tabindex="-1"></a><span class="co">#&gt; $slip$advice</span></span>
<span id="cb102-8"><a href="apis.html#cb102-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;True happiness always resides in the quest.&quot;</span></span></code></pre></div>
</div>
</div>
<div id="example-search-with-advice-id" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> Example: Search with Advice ID<a href="apis.html#example-search-with-advice-id" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Advice Slip API also allows you to request an advice based on its ID.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-130"></span>
<img src="images/api/advice-slip-by-id.png" alt="Random advices by id" width="80%" />
<p class="caption">
Figure 10.3: Random advices by id
</p>
</div>
<p>For example, the id = 5 results in the following advice:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-131"></span>
<img src="images/api/advice-slip-id5.png" alt="Random advice from Advice Slip" width="70%" />
<p class="caption">
Figure 10.4: Random advice from Advice Slip
</p>
</div>
<p>To make this request from R, we create the request object, and then perform
such request</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="apis.html#cb103-1" tabindex="-1"></a><span class="co"># advice id=5</span></span>
<span id="cb103-2"><a href="apis.html#cb103-2" tabindex="-1"></a>resp_advice_id5 <span class="ot">&lt;-</span> req <span class="sc">|&gt;</span></span>
<span id="cb103-3"><a href="apis.html#cb103-3" tabindex="-1"></a>  <span class="fu">req_url_path_append</span>(<span class="st">&quot;advice/5&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb103-4"><a href="apis.html#cb103-4" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb103-5"><a href="apis.html#cb103-5" tabindex="-1"></a></span>
<span id="cb103-6"><a href="apis.html#cb103-6" tabindex="-1"></a>resp_advice_id5</span>
<span id="cb103-7"><a href="apis.html#cb103-7" tabindex="-1"></a><span class="co">#&gt; &lt;httr2_response&gt;</span></span>
<span id="cb103-8"><a href="apis.html#cb103-8" tabindex="-1"></a><span class="co">#&gt; GET https://api.adviceslip.com/advice/5</span></span>
<span id="cb103-9"><a href="apis.html#cb103-9" tabindex="-1"></a><span class="co">#&gt; Status: 200 OK</span></span>
<span id="cb103-10"><a href="apis.html#cb103-10" tabindex="-1"></a><span class="co">#&gt; Content-Type: text/html</span></span>
<span id="cb103-11"><a href="apis.html#cb103-11" tabindex="-1"></a><span class="co">#&gt; Body: In memory (66 bytes)</span></span></code></pre></div>
<p>We can then extract the response body, for instance:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="apis.html#cb104-1" tabindex="-1"></a>advice_id5 <span class="ot">=</span> resp_advice_id5 <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb104-2"><a href="apis.html#cb104-2" tabindex="-1"></a>advice_id5</span>
<span id="cb104-3"><a href="apis.html#cb104-3" tabindex="-1"></a><span class="co">#&gt; $slip</span></span>
<span id="cb104-4"><a href="apis.html#cb104-4" tabindex="-1"></a><span class="co">#&gt; $slip$id</span></span>
<span id="cb104-5"><a href="apis.html#cb104-5" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb104-6"><a href="apis.html#cb104-6" tabindex="-1"></a></span>
<span id="cb104-7"><a href="apis.html#cb104-7" tabindex="-1"></a><span class="co">#&gt; $slip$advice</span></span>
<span id="cb104-8"><a href="apis.html#cb104-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;If you have the chance, take it!&quot;</span></span></code></pre></div>
</div>
<div id="example-search-query" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> Example: Search Query<a href="apis.html#example-search-query" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another kind of request that you can do with the Advice Slip API is to search
for an advice specifying a search query:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-134"></span>
<img src="images/api/advice-slip-search.png" alt="Random advices with search query" width="70%" />
<p class="caption">
Figure 10.5: Random advices with search query
</p>
</div>
<p>For example, say we are interested in searching for advice that includes the
word <strong>chance</strong>. The corresponding URL path will have the following form:</p>
<p><code>https://api.adviceslip.com/advice/search/chance</code></p>
<p>And the resulting output looks like this:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-135"></span>
<img src="images/api/advice-slip-chance.png" alt="Random advices with search query 'chance'" width="75%" />
<p class="caption">
Figure 10.6: Random advices with search query ‘chance’
</p>
</div>
<p>Let’s create a request that searches for the term <code>chance</code>. For sake of
illustration, let’s build a request object by appending the path elements:
<code>advice</code>, <code>search</code>, and <code>chance</code></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="apis.html#cb105-1" tabindex="-1"></a><span class="co"># advice id=5</span></span>
<span id="cb105-2"><a href="apis.html#cb105-2" tabindex="-1"></a>resp_advice_chance <span class="ot">&lt;-</span> req <span class="sc">|&gt;</span></span>
<span id="cb105-3"><a href="apis.html#cb105-3" tabindex="-1"></a>  <span class="fu">req_url_path_append</span>(<span class="st">&quot;advice&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb105-4"><a href="apis.html#cb105-4" tabindex="-1"></a>  <span class="fu">req_url_path_append</span>(<span class="st">&quot;search&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb105-5"><a href="apis.html#cb105-5" tabindex="-1"></a>  <span class="fu">req_url_path_append</span>(<span class="st">&quot;chance&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb105-6"><a href="apis.html#cb105-6" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span></code></pre></div>
<p>The above command can be shorten as:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="apis.html#cb106-1" tabindex="-1"></a><span class="co"># advice id=5</span></span>
<span id="cb106-2"><a href="apis.html#cb106-2" tabindex="-1"></a>resp_advice_chance <span class="ot">&lt;-</span> req <span class="sc">|&gt;</span></span>
<span id="cb106-3"><a href="apis.html#cb106-3" tabindex="-1"></a>  <span class="fu">req_url_path_append</span>(<span class="st">&quot;advice/search/chance&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb106-4"><a href="apis.html#cb106-4" tabindex="-1"></a>  <span class="fu">req_perform</span>()</span>
<span id="cb106-5"><a href="apis.html#cb106-5" tabindex="-1"></a></span>
<span id="cb106-6"><a href="apis.html#cb106-6" tabindex="-1"></a>resp_advice_chance</span>
<span id="cb106-7"><a href="apis.html#cb106-7" tabindex="-1"></a><span class="co">#&gt; &lt;httr2_response&gt;</span></span>
<span id="cb106-8"><a href="apis.html#cb106-8" tabindex="-1"></a><span class="co">#&gt; GET https://api.adviceslip.com/advice/search/chance</span></span>
<span id="cb106-9"><a href="apis.html#cb106-9" tabindex="-1"></a><span class="co">#&gt; Status: 200 OK</span></span>
<span id="cb106-10"><a href="apis.html#cb106-10" tabindex="-1"></a><span class="co">#&gt; Content-Type: text/html</span></span>
<span id="cb106-11"><a href="apis.html#cb106-11" tabindex="-1"></a><span class="co">#&gt; Body: In memory (402 bytes)</span></span></code></pre></div>
<p>Having performed the request, we fetch the data by extracting the body as a
string (in JSON format), and then parsing it with <code>fromJSON()</code></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="apis.html#cb107-1" tabindex="-1"></a>advice_chance <span class="ot">=</span> resp_advice_chance <span class="sc">|&gt;</span> <span class="fu">resp_body_string</span>() <span class="sc">|&gt;</span> <span class="fu">fromJSON</span>()</span>
<span id="cb107-2"><a href="apis.html#cb107-2" tabindex="-1"></a></span>
<span id="cb107-3"><a href="apis.html#cb107-3" tabindex="-1"></a><span class="fu">names</span>(advice_chance)</span>
<span id="cb107-4"><a href="apis.html#cb107-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;total_results&quot; &quot;query&quot;         &quot;slips&quot; </span></span></code></pre></div>
<p>The <code>"slips"</code> element contains a data frame with 3 advice recommendations
(the last two are actually the same advice):</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="apis.html#cb108-1" tabindex="-1"></a>advice_chance<span class="sc">$</span>slips</span>
<span id="cb108-2"><a href="apis.html#cb108-2" tabindex="-1"></a><span class="co">#&gt;    id</span></span>
<span id="cb108-3"><a href="apis.html#cb108-3" tabindex="-1"></a><span class="co">#&gt; 1   5</span></span>
<span id="cb108-4"><a href="apis.html#cb108-4" tabindex="-1"></a><span class="co">#&gt; 2 184</span></span>
<span id="cb108-5"><a href="apis.html#cb108-5" tabindex="-1"></a><span class="co">#&gt; 3 185</span></span>
<span id="cb108-6"><a href="apis.html#cb108-6" tabindex="-1"></a><span class="co">#&gt;                                                                                            advice</span></span>
<span id="cb108-7"><a href="apis.html#cb108-7" tabindex="-1"></a><span class="co">#&gt; 1                                                                If you have the chance, take it!</span></span>
<span id="cb108-8"><a href="apis.html#cb108-8" tabindex="-1"></a><span class="co">#&gt; 2 You can fail at what you don&#39;t want. So you might as well take a chance on doing what you love.</span></span>
<span id="cb108-9"><a href="apis.html#cb108-9" tabindex="-1"></a><span class="co">#&gt; 3 You can fail at what you don&#39;t want. So you might as well take a chance on doing what you love.</span></span>
<span id="cb108-10"><a href="apis.html#cb108-10" tabindex="-1"></a><span class="co">#&gt;         date</span></span>
<span id="cb108-11"><a href="apis.html#cb108-11" tabindex="-1"></a><span class="co">#&gt; 1 2016-12-25</span></span>
<span id="cb108-12"><a href="apis.html#cb108-12" tabindex="-1"></a><span class="co">#&gt; 2 2017-03-10</span></span>
<span id="cb108-13"><a href="apis.html#cb108-13" tabindex="-1"></a><span class="co">#&gt; 3 2016-08-05</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="jsonlite.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="api-open-notify.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-web-tech.pdf", "R-web-tech.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
